<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>推しとの運試し！おみくじ</title>
    <!-- Tailwind CSSを読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Interを読み込み -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* カスタムカラーとベーススタイル */
        :root {
            --main-color: #ec4899; /* Pink-600 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* Gray-800 */
            color: #f3f4f6; /* Gray-100 */
        }
        .container {
            min-height: 100vh;
        }
        /* おみくじボタンのスタイル */
        #draw-button {
            transition: all 0.15s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
        }
        #draw-button:active {
            transform: translateY(2px);
            box-shadow: none;
        }
        
        /* 結果表示用の画像スタイル - ここを正方形に修正しました！ */
        #placeholder-image {
            width: 100%; /* 親要素の幅いっぱいに */
            aspect-ratio: 1 / 1; /* 縦横比を1:1に強制 */
            object-fit: cover; /* 画像がはみ出る場合は中央からトリミング */
            max-height: 500px; /* 最大高さを設定 (PCなどで大きくなりすぎないように) */
            margin-bottom: 1.5rem;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* 結果テキストのアニメーション */
        .result-text {
            opacity: 0;
            transform: translateY(10px);
            animation: fadeInSlideUp 0.6s ease-out forwards;
        }
        @keyframes fadeInSlideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    
    <div class="container max-w-lg mx-auto flex flex-col items-center justify-center text-center">
        <!-- ヘッダー -->
        <h1 class="text-4xl font-extrabold mb-8 text-pink-400">
            推しとの運試し！おみくじ
        </h1>
        <p class="mb-8 text-xl text-gray-300">
            ボタンを押して、今日の運勢を占おう！
        </p>

        <!-- 画像表示エリア -->
        <img id="placeholder-image" 
             src="https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" 
             alt="推しグループのイメージ画像" 
             class="w-full h-auto object-cover rounded-xl shadow-2xl transition-opacity duration-500"
        >

        <!-- 結果表示エリア -->
        <div id="result-area" class="w-full mb-8 min-h-[100px]">
            <p id="result-text" class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-pink-500 result-text" style="opacity: 0;">
                
            </p>
        </div>

        <!-- おみくじボタン -->
        <button id="draw-button" 
                class="w-full py-4 px-6 bg-pink-600 hover:bg-pink-700 text-white font-bold text-2xl rounded-xl cursor-pointer shadow-lg transform active:scale-98 transition duration-150 ease-in-out"
        >
            おみくじを引く！
        </button>
    </div>

    <script>
        // おみくじの結果データ
        // 確率の重み付け (weight) を設定
        const omikujiResults = [
            // 大吉
            { result: "大吉！", detail: "今日のあなたは最高潮の運勢！推しとの絆が深まる予感...", weight: 30, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" },
            // 吉
            { result: "吉！", detail: "安定した良い運勢。推しの新しい情報に恵まれそう。", weight: 40, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" },
            // 中吉
            { result: "中吉！", detail: "まずまずの運勢。SNSでの推しの投稿を見逃さないで！", weight: 50, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" },
            // 小吉
            { result: "小吉...", detail: "普通の日ですが、油断は禁物。小さな幸せを見つけて。", weight: 30, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" },
            // 末吉
            { result: "末吉...", detail: "可もなく不可もなく。次のライブに向けて体力を温存。", weight: 20, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" },
            // 凶
            { result: "凶...", detail: "今日は少し注意が必要。ポジティブな気持ちで乗り切ろう！", weight: 10, image: "https://raw.githubusercontent.com/elephants19660612-del/omikuji-generator/main/kanaboon_jackintour_2.png" }
        ];

        // 要素の取得
        const drawButton = document.getElementById('draw-button');
        const resultTextElement = document.getElementById('result-text');
        const imageElement = document.getElementById('placeholder-image');
        
        // 合計の重みを計算
        const totalWeight = omikujiResults.reduce((sum, item) => sum + item.weight, 0);

        // 重み付けに基づいて結果を選択する関数
        function getWeightedRandomResult() {
            let random = Math.floor(Math.random() * totalWeight);
            let cumulativeWeight = 0;
            
            for (const item of omikujiResults) {
                cumulativeWeight += item.weight;
                if (random < cumulativeWeight) {
                    return item;
                }
            }
        }

        // おみくじを引く処理
        function drawOmikuji() {
            // ボタンを無効化（連打防止）
            drawButton.disabled = true;
            drawButton.textContent = '運勢を占っています...';
            
            // 結果テキストと画像を一度非表示にするアニメーション
            resultTextElement.style.opacity = '0';
            imageElement.classList.remove('transition-opacity', 'duration-500'); // 一時的にトランジションを削除
            imageElement.style.opacity = '0'; 

            // 1秒後に結果を表示
            setTimeout(() => {
                const result = getWeightedRandomResult();

                // 結果テキストを更新
                resultTextElement.innerHTML = `
                    <span class="block">${result.result}</span>
                    <span class="block text-xl font-normal text-gray-300 mt-2">${result.detail}</span>
                `;
                
                // 画像を更新（画像はここではすべて同じURLですが、将来的に結果によって変えられます）
                // NOTE: imageElement.src = result.image; // 将来的に画像を変えるためのコード
                
                // 結果テキストと画像をフェードイン
                resultTextElement.style.opacity = '1';
                imageElement.classList.add('transition-opacity', 'duration-500'); // 再度トランジションを設定
                imageElement.style.opacity = '1'; 

                // ボタンの表示を戻す
                drawButton.disabled = false;
                drawButton.textContent = 'もう一度引く';
                
            }, 1000); // 1秒間のディレイ
        }

        // イベントリスナーを設定
        drawButton.addEventListener('click', drawOmikuji);

        // 初回ロード時に画像をフェードイン
        document.addEventListener('DOMContentLoaded', () => {
             // 初回ロード時はまだ結果がないためテキストは非表示
             resultTextElement.style.opacity = '0';
             // 画像をゆっくり表示
             imageElement.style.opacity = '1';
        });

    </script>
</body>
</html>
